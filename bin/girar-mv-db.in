#!/bin/sh -efu

. "@CMDDIR@/girar-sh-functions"

PROG=girar-mv-db

usage()
{
	echo "$PROG: $*" >&2
	echo "usage: $PROG <source-directory> <dest-directory>" >&2
	exit 1
}

[ "$#" -ge 2 ] ||
	usage 'Not enough arguments.'
[ "$#" -eq 2 ] ||
	usage 'Too many arguments.'

cd "$HOME"

srcdir0="$1"; shift
srcdir="$(validate_packages_dir "$srcdir0")"
srcdir="$(add_git_suffix "$srcdir")"

dstdir0="$1"; shift
dstdir="$(validate_packages_dir "$dstdir0")"
dstdir="$(add_git_suffix "$dstdir")"

[ -d "$srcdir" ] ||
	fatal "$srcdir0: source directory not available"
[ ! -e "$dstdir" ] ||
	fatal "$dstdir0: destination directory already exists"

cd "$srcdir"
cd "$HOME"
mkdir -- "$dstdir"
mv -T -- "$srcdir" "$dstdir"
