#!/bin/sh -eu

. "@CMDDIR@/girar-sh-functions"

PROG=girar-find-package

usage()
{
	echo >&2 "$PROG: $*"
	echo >&2 "usage: $PROG <pattern>"
	exit 1
}

[ "$#" -ge 1 ] ||
	usage 'Not enough arguments.'
[ "$#" -eq 1 ] ||
	usage 'Too many arguments.'

[ -n "$1" -a -n "${1##*/*}" ] || 
        fatal 'invalid pattern'

[ -n "${GIRAR_HOME:-}" ] ||
	fatal 'GIRAR_HOME undefined'

cd "$GIRAR_HOME"
for d in [a-z]*; do
	[ -d "$d" ] || continue
	find "$GIRAR_HOME/$d/packages/" -mindepth 1 -maxdepth 1 -type d \
		\( -name "$1" -or -name "$1.git" \) -print ||:
done
