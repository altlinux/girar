#!/bin/sh -efu

. girar-sh-functions

usage()
{
	echo >&2 "$PROG: $*"
	echo >&2 "usage: $PROG <path to directory>"
	exit 1
}

[ "$#" -ge 1 ] ||
	usage 'Not enough arguments.'
[ "$#" -eq 1 ] ||
	usage 'Too many arguments.'

cd

dir="$(validate_packages_dir "$1")"; shift
dir="$(add_git_suffix "$dir")"
mkdir -- "$dir"
cd "$dir"
GIT_DIR=. git init --template="$GIRAR_TEMPLATES_DIR" >/dev/null
echo "${dir%.git}" >description
install -m600 -- /dev/null git-daemon-export-ok
printf '%s:\t%s\n' "$PROG" "$PWD"
